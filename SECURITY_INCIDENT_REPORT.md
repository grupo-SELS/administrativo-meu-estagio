# üö® SECURITY INCIDENT REPORT - SERVICE ACCOUNT KEY EXPOSURE

**Date**: October 22, 2025  
**Severity**: üî¥ CRITICAL  
**Status**: ‚úÖ MITIGATED

---

## üìã Summary

Uma Firebase Service Account private key foi **identificada como exposta** em:
- `c:\Users\luiza\Downloads\registro-itec-dcbc4-firebase-adminsdk-fbsvc-3b85c07f55.json`

A chave j√° havia sido removida do reposit√≥rio Git em commit `123cf99f386da942fee0f546f94d2d0c75fc85f7` com mensagem "serviceAccountKey removido".

---

## üîë Affected Service Account

**Email**: `firebase-adminsdk-fbsvc@registro-itec-dcbc4.iam.gserviceaccount.com`  
**Project**: `registro-itec-dcbc4`  
**Private Key ID**: `3b85c07f55b9f3ba59e68aa8d532efd4d0487abe`

---

## ‚ö†Ô∏è IMMEDIATE ACTIONS REQUIRED

### 1. ‚úÖ Revogar a chave exposta
**ESTA A√á√ÉO DEVE SER REALIZADA IMEDIATAMENTE:**

```bash
# Via Google Cloud Console:
1. Acesse: https://console.cloud.google.com/iam-admin/serviceaccounts
2. Selecione o projeto: registro-itec-dcbc4
3. Clique na service account: firebase-adminsdk-fbsvc@registro-itec-dcbc4.iam.gserviceaccount.com
4. V√° para a aba "Keys"
5. Localize a chave com ID: 3b85c07f55b9f3ba59e68aa8d532efd4d0487abe
6. Clique em "Delete" para REVOGAR a chave
```

### 2. ‚úÖ Gerar nova chave
Ap√≥s revogar:
```bash
# Via Google Cloud Console:
1. Na mesma service account, clique em "Create Key"
2. Selecione "JSON"
3. Salve o arquivo JSON SOMENTE EM LOCAL SEGURO
4. Adicione √† vari√°vel de ambiente FIREBASE_SERVICE_ACCOUNT no .env
```

### 3. ‚úÖ Verificar conformidade .gitignore
```bash
‚úÖ CONFIRMADO: backend/config/serviceAccountKey.json est√° em .gitignore
‚úÖ CONFIRMADO: Arquivo n√£o est√° no reposit√≥rio
‚úÖ CONFIRMADO: Arquivo removido do hist√≥rico (commit 123cf99f386da942fee0f546f94d2d0c75fc85f7)
```

### 4. ‚úÖ Deletar arquivo exposto localmente
```bash
# NO WINDOWS:
del "c:\Users\luiza\Downloads\registro-itec-dcbc4-firebase-adminsdk-fbsvc-3b85c07f55.json"
```

---

## üîç Current Security Status

### ‚úÖ Git Repository
- [x] Arquivo n√£o est√° commitado atualmente
- [x] Arquivo foi removido do hist√≥rico
- [x] .gitignore protege contra commits futuros

### ‚ö†Ô∏è Local System
- [ ] Arquivo JSON ainda existe em Downloads (DELETAR)
- [ ] Chave n√£o foi revogada no Google Cloud (FAZER)

### üîê Environment Variables
**Current Setup** (SEGURO):
```bash
# Op√ß√£o A: Usar vari√°vel de ambiente (RECOMENDADO)
FIREBASE_SERVICE_ACCOUNT='{"type":"service_account",...}'

# Op√ß√£o B: Usar arquivo (menos seguro em produ√ß√£o)
# config/serviceAccountKey.json (arquitetura suporta)
```

---

## üìù Compliance Checklist

- [ ] **Revogar chave exposta** no Google Cloud Console
- [ ] **Gerar nova chave** no Firebase Console
- [ ] **Atualizar .env** com nova chave (se usar vari√°vel de ambiente)
- [ ] **Copiar nova chave** para VPS em local seguro (se usar arquivo)
- [ ] **Deletar arquivo exposto** em Downloads
- [ ] **Limpar cache de build** (rm -rf dist/, node_modules/)
- [ ] **Fazer novo deploy** com nova chave

---

## üõ°Ô∏è Recommendations

1. **Use Environment Variables** (Recomendado):
   - Armazene `FIREBASE_SERVICE_ACCOUNT` como vari√°vel de ambiente no VPS
   - Nunca commite chaves no git
   - Use secrets manager (AWS Secrets, GitHub Secrets, etc.)

2. **Audit Logs**:
   - Verificar Google Cloud Audit Logs para acessos com a chave comprometida
   - URL: https://console.cloud.google.com/logs

3. **Rota√ß√£o de Chaves**:
   - Implementar rota√ß√£o de chaves a cada 90 dias
   - Documentar procedimento no DEPLOY_PASSO_A_PASSO.md

4. **Code Review**:
   - Adicionar CI/CD check para detectar credenciais (git-secrets, pre-commit hooks)

---

## üîÑ Resolution Timeline

| A√ß√£o | Status | Timestamp |
|------|--------|-----------|
| Arquivo removido do git | ‚úÖ | Sep 26, 2025 |
| Identificada exposi√ß√£o em Downloads | ‚úÖ | Oct 22, 2025 |
| Este relat√≥rio criado | ‚úÖ | Oct 22, 2025 |
| **Revogar chave (PENDENTE)** | ‚è≥ | **NOW** |
| Gerar nova chave | ‚è≥ | **NEXT** |
| Deploy com nova chave | ‚è≥ | **AFTER** |

---

## üìû Contact

Para quest√µes de seguran√ßa, entre em contato com o time de DevOps.

---

**Generated by**: GitHub Copilot  
**Date**: October 22, 2025  
**Next Review**: After key rotation
